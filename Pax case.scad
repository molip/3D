wall = 0.5;
base = 1;
inner = [31.5, 22.3, 60];
lid_angle = 15;
lid_gap = 0;
lid_height = 8; // Outer height from top, x=0

outer = [inner.x + wall * 2, inner.y + wall * 2, inner.z + base * 2];
lid_height_delta = sin(lid_angle) * outer.x;

module outline() 
{
	data_extents = [[950.464, 897.76], [1323.82, 1159.95]];

	scale([inner.x / (data_extents[1].x - data_extents[0].x), inner.y / (data_extents[1].y - data_extents[0].y)])
	translate([-data_extents[0].x, -data_extents[0].y])
	translate([(data_extents[0].x - data_extents[1].x) / 2, (data_extents[0].y - data_extents[1].y) / 2])
	polygon
	([
		[1108.56399023,897.973521484], [1077.75648438,899.779046875], [1062.09858765,901.752113037], [1046.58201758,904.691142578], [1031.43984106,908.785456299], [1016.905125,914.224375], [1003.21093628,921.197219482], [990.590341797,929.893310547], [979.276408447,940.501968994], [969.502203125,953.212515625], [961.500792725,968.21427124], [955.505244141,985.696556641], [951.748624268,1005.84869263], [950.464,1028.86], [951.748624268,1051.86990967], [955.505244141,1072.02083984], [961.500792725,1089.50209229], [969.502203125,1104.50296875], [979.276408447,1117.212771], [990.590341797,1127.82080078], [1003.21093628,1136.51635986], [1016.905125,1143.48875], [1031.43984106,1148.92727295], [1046.58201758,1153.02123047], [1062.09858765,1155.95992432], [1077.75648438,1157.93265625], [1108.56399023,1159.73744141], [1137.14,1159.95], [1165.71597656,1159.73744141], [1196.5234375,1157.93265625], [1212.18133301,1155.95992432], [1227.69792969,1153.02123047], [1242.8401709,1148.92727295], [1257.375,1143.48875], [1271.06936035,1136.51635986], [1283.69019531,1127.82080078], [1295.00444824,1117.212771], [1304.7790625,1104.50296875], [1312.78098145,1089.50209229], [1318.77714844,1072.02083984], [1322.53450684,1051.86990967], [1323.82,1028.86], [1322.53450684,1005.84869263], [1318.77714844,985.696556641], [1312.78098145,968.21427124], [1304.7790625,953.212515625], [1295.00444824,940.501968994], [1283.69019531,929.893310547], [1271.06936035,921.197219482], [1257.375,914.224375], [1242.8401709,908.785456299], [1227.69792969,904.691142578], [1212.18133301,901.752113037], [1196.5234375,899.779046875], [1165.71597656,897.973521484], [1137.14,897.76]	
	]);
}

module clip(height)
{
	s = [outer.x * 2, outer.y * 2, lid_height_delta * 2];
	translate([0, 0, height])
	rotate([0, lid_angle, 0])
	translate([-s.x / 2, -s.y / 2, 0])
	cube(s);
}

module tube(outer_height)
{
	difference()
	{
		h = wall + outer_height + lid_height_delta / 2;
		linear_extrude(h) offset(r=wall) outline();
		translate([0, 0, base]) linear_extrude(h) outline();
		clip(outer_height);
	}
}

module body()
{
	color("yellow") 
	tube(outer.z - lid_height);
}

module lid()
{
	color("red") 
	translate([0, 0, outer.z + lid_gap]) 
	rotate([0, 180, 0])
	tube(lid_height);
}

module main()
{
	body();
	lid();
}

main();
